"use strict";function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _createSuper(i){var n=_isNativeReflectConstruct();return function(){var e,t=_getPrototypeOf(i);return _possibleConstructorReturn(this,n?(e=_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _wrapNativeSuper(e){var i="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(e){if(null===e||!_isNativeFunction(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==i){if(i.has(e))return i.get(e);i.set(e,t)}function t(){return _construct(e,arguments,_getPrototypeOf(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(t,e)})(e)}function _construct(e,t,i){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(e,t,i){var n=[null];n.push.apply(n,t);var r=new(Function.bind.apply(e,n));return i&&_setPrototypeOf(r,i.prototype),r}).apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function _isNativeFunction(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _createForOfIteratorHelper(e,t){var i;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return s=e.done,e},e:function(e){l=!0,o=e},f:function(){try{s||null==i.return||i.return()}finally{if(l)throw o}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,t){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("justAnotherWin",t):(e=e||self).justAnotherWin=t()}(void 0,function(){function r(n,e,t,i,r){var o,s=3<arguments.length&&void 0!==i&&i,l=4<arguments.length&&void 0!==r&&r,h=[e].flat(),a=[t].flat(),d=_createForOfIteratorHelper(h);try{for(d.s();!(o=d.n()).done;)!function(){var e=o.value,i=n[e];n[e]=function(){var t=[].slice.apply(arguments);s&&l?(i.call.apply(i,[n].concat(_toConsumableArray(t))),a.forEach(function(e){return e.apply(void 0,_toConsumableArray(t))})):(a.forEach(function(e){return e.apply(void 0,_toConsumableArray(t))}),s&&i.call.apply(i,[n].concat(_toConsumableArray(t))))}}()}catch(e){d.e(e)}finally{d.f()}}var i=function(){_inherits(i,_wrapNativeSuper(EventTarget));var t=_createSuper(i);function i(){var e;return _classCallCheck(this,i),(e=t.call(this)).listeners={"*":[]},e}return _createClass(i,[{key:"on",value:function(e,t,i){var n=2<arguments.length&&void 0!==i&&i;this.listeners[e]?this.listeners[e].push(t):this.listeners[e]=[t],n?this.addEventListener(e,t,{once:!0}):this.addEventListener(e,t)}},{key:"off",value:function(t,e){var i,n=this,r=1<arguments.length&&void 0!==e&&e;this.listeners[t]&&(i=function(e){n.removeEventListener(t,e)},r&&"function"==typeof r?(n.listeners[t]=n.listeners[t].filter(function(e){return e===r?i(e):e}),0===n.listeners[t].length&&"*"!==t&&delete n.listeners[t]):function(){for(var e=n.listeners[t].length;e--;)i(n.listeners[t][e]);"*"!==t?delete n.listeners[t]:n.listeners[t]=[]}())}},{key:"emit",value:function(e,t){0<this.listeners["*"].length&&this.dispatchEvent(new CustomEvent("*",{detail:t})),this.dispatchEvent(new CustomEvent(e,{detail:t}))}},{key:"once",value:function(e,t){this.on(e,t,!0)}}]),i}();function m(e){return e instanceof Element||e instanceof HTMLDocument}var e=(_createClass(t,[{key:"createNode",value:function(e,t,i,n,r,o,s){var l=this,h=1<arguments.length&&void 0!==t?t:null,a=2<arguments.length&&void 0!==i?i:null,d=3<arguments.length&&void 0!==n?n:null,u=4<arguments.length&&void 0!==r?r:null,c=5<arguments.length&&void 0!==o?o:null,f=6<arguments.length&&void 0!==s?s:null;return this.element=document.createElement(e),h&&this.addClasses(h),a&&(this.element.id=a),d&&(d=[d].flat()).forEach(function(e){switch(_typeof(e)){case"string":l.element.innerText=e;break;case"number":l.element.innerText=e.toString();break;case"object":m(e)&&l.element.appendChild(e)}}),u&&(Array.isArray(u)?u.forEach(function(e){l.createListener(e)}):this.createListener(u)),f&&this.addInlineStyle(c),c&&this.addCustomAttr(c),this}},{key:"addClasses",value:function(e,t){var i=this,n=1<arguments.length&&void 0!==t?t:null;return(e=[e].flat()).forEach(function(e){var t;(t=(n||i.element).classList).add.apply(t,_toConsumableArray(e.split(" ")))}),this}},{key:"addStyle",value:function(t,e){var i=this,n=1<arguments.length&&void 0!==e?e:null;return Object.keys(t).forEach(function(e){(n||i.element).style[e]=t[e]}),this}},{key:"addCustomAttr",value:function(e,t){var i=this,n=1<arguments.length&&void 0!==t?t:null;return(e=[e].flat()).forEach(function(e){(n||i.element).setAttribute(e.type,e.val)}),this}},{key:"createListener",value:function(t,e){var i=1<arguments.length&&void 0!==e?e:null;return t.hasOwnProperty("args")||(t.args=[]),(i||this.element).addEventListener(t.type,function(e){return t.hasOwnProperty("event")&&!t.event?t.callback.apply(t,_toConsumableArray(t.args)):t.callback.apply(t,[e].concat(_toConsumableArray(t.args))),!1}),this}},{key:"fill",value:function(e,t){var i,n=1<arguments.length&&void 0!==t?t:null,r=n||this.element;return m(e)?r.appendChild(e):((i=document.createElement("p")).innerHTML=e,r.appendChild(i)),this}},{key:"done",value:function(){return this.element}},{key:"enclose",value:function(e,t,i,n,r){var o=this,s=1<arguments.length&&void 0!==t?t:null,l=2<arguments.length&&void 0!==i?i:"div",h=3<arguments.length&&void 0!==n?n:null,a=4<arguments.length&&void 0!==r?r:null;this.element=document.createElement(l);var d,u=[e].flat(),c=_createForOfIteratorHelper(u);try{for(c.s();!(d=c.n()).done;){var f=d.value;m(f)&&this.element.appendChild(f)}}catch(e){c.e(e)}finally{c.f()}return a&&u.forEach(function(e){o.addCustomAttr(a,e)}),s&&this.addClasses(s),h&&[h].flat().forEach(function(e){o.createListener(e)}),this}}]),t);function t(){_classCallCheck(this,t),_defineProperty(this,"element",null)}var n=new e,o=(_createClass(s,[{key:"createPreviewNode",value:function(){return n.createNode("div","win2-max-preview").addStyle(this.previewStyle).done()}},{key:"preview",value:function(e,t){e?e!==this.previewingSide&&(this.previewEl&&this.removePreview(),this.previewingSide=e,this.previewEl=this.createPreviewNode(),this["preview".concat(e.charAt(0).toUpperCase()+e.slice(1))](t)):this.removePreview()}},{key:"previewLeft",value:function(e){this.previewEl.style.left=0,this.previewEl.style.zIndex=e-1,document.body.appendChild(this.previewEl),this.previewEl.animate(this.keyFrames.side,this.timing)}},{key:"previewRight",value:function(e){this.previewEl.style.right=0,this.previewEl.style.zIndex=e-1,document.body.appendChild(this.previewEl),this.previewEl.animate(this.keyFrames.side,this.timing)}},{key:"previewTop",value:function(e){this.previewEl.style.top=0,this.previewEl.style.zIndex=e-1,document.body.appendChild(this.previewEl),this.previewEl.animate(this.keyFrames.top,this.timing)}},{key:"removePreview",value:function(){this.previewEl&&(this.previewEl.remove(),this.previewEl=null,this.previewingSide=null)}}]),s);function s(){_classCallCheck(this,s),this.previewingSide=null,this.previewEl=null,this.previewStyle={position:"absolute",boxShadow:"inset 0px 0px 0px 5px darkgrey"},this.keyFrames={top:[{width:window.innerWidth/1.5+"px",height:window.innerHeight/1.5+"px",right:window.innerWidth/2-window.innerWidth/1.5/2+"px"},{right:0,width:window.innerWidth+"px",height:window.innerHeight+"px"}],side:[{width:window.innerWidth/3+"px",height:window.innerWidth/3+"px",top:window.innerHeight/2-window.innerWidth/3/2+"px"},{top:0,width:window.innerWidth/2+"px",height:window.innerHeight+"px"}]},this.timing={duration:100,fill:"forwards"}}var l=(_createClass(h,[{key:"getCursorPos",value:function(e,t){var i=0<arguments.length&&void 0!==e?e:null,n=1<arguments.length&&void 0!==t?t:null;if(!n||!i)return this.lastPos;var r=i.getBoundingClientRect();return this.lastPos={x:Math.floor((n.clientX-r.left)/(r.right-r.left)*i.offsetWidth),y:Math.floor((n.clientY-r.top)/(r.bottom-r.top)*i.offsetHeight)},this.lastPos}}]),h);function h(){_classCallCheck(this,h),this.lastPos=null}var a=new e,d=new l,u=(_createClass(c,[{key:"build",value:function(){var t,i,n,e={escapeBtnListener:{type:"click",callback:this.removeEl.bind(this)},minimizeBtnListener:{type:"click",callback:this.minimize.bind(this)},maximizeBtnListener:{type:"click",callback:this.maximizeTrigger.bind(this)},headerMouseDownListener:{type:"mousedown",callback:this.focus.bind(this)},headerDblClickListener:{type:"dblclick",callback:this.maximizeTrigger.bind(this)},containerMouseDownListener:{type:"mousedown",callback:this.focus.bind(this,null)},borders:{type:"mousedown",callback:this.borderSelect.bind(this)}},r={borderWidth:"".concat(this.borderWidth,"px"),cornerSize:"".concat(this.cornerSize,"px"),headerHeight:"".concat(this.headerHeight,"px"),minimizeBtnContent:this.minimizeBtnContent,maximizeBtnContent:this.maximizeBtnContent,escapeBtnContent:this.escapeBtnContent,entete:this.entete,enteteIcon:this.enteteIcon};return t=e,n=null,n=(i=r).enteteIcon?a.enclose([a.enclose(i.enteteIcon.cloneNode(!0),"win2-icon-container").addStyle({display:"inline",position:"relative",top:"2px",left:"2px"}).done(),a.createNode("p",null,null,i.entete.toString()).addStyle({margin:"0 5px 0 7px",display:"inline"}).done()],"win2-entete-container").done():a.createNode("p",null,null,i.entete.toString()).addStyle({margin:"0 5px 0 7px",display:"inline"}).done(),new function(){var e=this;this.borderTop=a.createNode("div","win2-border-top win2-border",null,null,t.borders,{type:"data-resize",val:"top"}).addStyle({top:0,left:i.cornerSize,width:"calc(100% - ".concat(i.cornerSize," * 2)"),height:i.borderWidth,cursor:"ns-resize",position:"absolute",backgroundColor:"lightgrey"}).done(),this.cornerTopRight=a.enclose([a.createNode("div","win2-corner-top-right win2-corner-hor").addStyle({width:i.cornerSize,height:i.borderWidth,top:0,right:0,position:"absolute",cursor:"nesw-resize",backgroundColor:"lightgrey"}).done(),a.createNode("div","win2-corner-top-right win2-corner-ver").addStyle({width:i.borderWidth,height:i.cornerSize,top:0,right:0,position:"absolute",cursor:"nesw-resize",backgroundColor:"lightgrey"}).done()],null,"div",t.borders,{type:"data-resize",val:"top-right"}).done(),this.borderRight=a.createNode("div","win2-border-right win2-border",null,null,t.borders,{type:"data-resize",val:"right"}).addStyle({top:i.cornerSize,right:0,width:i.borderWidth,height:"calc(100% - ".concat(i.cornerSize," * 2)"),cursor:"ew-resize",position:"absolute",backgroundColor:"lightgrey"}).done(),this.cornerTopLeft=a.enclose([a.createNode("div","win2-corner-top-left win2-corner-hor").addStyle({width:i.cornerSize,height:i.borderWidth,top:0,left:0,position:"absolute",cursor:"nwse-resize",backgroundColor:"lightgrey"}).done(),a.createNode("div","win2-corner-top-left win2-corner-ver").addStyle({width:i.borderWidth,height:i.cornerSize,top:0,left:0,position:"absolute",cursor:"nwse-resize",backgroundColor:"lightgrey"}).done()],null,"div",t.borders,{type:"data-resize",val:"top-left"}).done(),this.borderBottom=a.createNode("div","win2-border-bottom win2-border",null,null,t.borders,{type:"data-resize",val:"bottom"}).addStyle({bottom:0,left:i.cornerSize,width:"calc(100% - ".concat(i.cornerSize," * 2)"),height:i.borderWidth,cursor:"ns-resize",position:"absolute",backgroundColor:"lightgrey"}).done(),this.cornerBottomRight=a.enclose([a.createNode("div","win2-corner-bottom-right win2-corner-hor").addStyle({width:i.cornerSize,height:i.borderWidth,bottom:0,right:0,position:"absolute",cursor:"nwse-resize",backgroundColor:"lightgrey"}).done(),a.createNode("div","win2-corner-bottom-right win2-corner-ver").addStyle({width:i.borderWidth,height:i.cornerSize,bottom:0,right:0,position:"absolute",cursor:"nwse-resize",backgroundColor:"lightgrey"}).done()],null,"div",t.borders,{type:"data-resize",val:"bottom-right"}).done(),this.borderLeft=a.createNode("div","win2-border-left win2-border",null,null,t.borders,{type:"data-resize",val:"left"}).addStyle({top:i.cornerSize,left:0,width:i.borderWidth,height:"calc(100% - ".concat(i.cornerSize," * 2)"),cursor:"ew-resize",position:"absolute",backgroundColor:"lightgrey"}).done(),this.cornerBottomLeft=a.enclose([a.createNode("div","win2-corner-bottom-left win2-corner-hor").addStyle({width:i.cornerSize,height:i.borderWidth,bottom:0,left:0,position:"absolute",cursor:"nesw-resize",backgroundColor:"lightgrey"}).done(),a.createNode("div","win2-corner-bottom-left win2-corner-ver").addStyle({width:i.borderWidth,height:i.cornerSize,bottom:0,left:0,position:"absolute",cursor:"nesw-resize",backgroundColor:"lightgrey"}).done()],null,"div",t.borders,{type:"data-resize",val:"bottom-left"}).done(),this.escapeBtn=a.createNode("button","win2-button win2-escape-btn",null,i.escapeBtnContent,t.escapeBtnListener).done(),this.minimizeBtn=a.createNode("button","win2-button win2-minimize-btn",null,i.minimizeBtnContent,t.minimizeBtnListener).done(),this.maximizeBtn=a.createNode("button","win2-button win2-maximize-btn",null,i.maximizeBtnContent,t.maximizeBtnListener).done(),this.enteteContainer=a.createNode("div","win2-entete",null,n).addStyle({cursor:"default"}).done(),this.body=a.createNode("div","win2-body",null).addStyle({overflow:"hidden",height:"calc(100% - ".concat("autopx"===i.headerHeight?"0px":i.headerHeight,")"),backgroundColor:"Bisque"}).done(),this.header=a.createNode("div","win2-header",null,[e.enteteContainer,a.enclose([e.minimizeBtn,e.maximizeBtn,e.escapeBtn],"win2-btn-container").done()],[t.headerMouseDownListener,t.headerDblClickListener]).addStyle({display:"flex",justifyContent:"space-between",height:i.headerHeight,backgroundColor:"BurlyWood"}).done(),this.windowContent=a.createNode("div","win2-content",null,[e.header,e.body]).addStyle({display:"flex",flexDirection:"column",position:"absolute",left:i.borderWidth,top:i.borderWidth,width:"calc(100% - ".concat(i.borderWidth," * 2)"),height:"calc(100% - ".concat(i.borderWidth," * 2)")}).done(),this.windowEl=a.createNode("div","win2-container",null,[e.windowContent,e.borderTop,e.cornerTopRight,e.borderRight,e.cornerBottomRight,e.borderBottom,e.cornerBottomLeft,e.borderLeft,e.cornerTopLeft],t.containerMouseDownListener).addStyle({position:"absolute"}).done()}}},{key:"create",value:function(){this.elements=this.build(),this.content&&this.elements.body.appendChild(this.content),this.winEl=this.elements.windowEl,this.updatePosAndShape(),document.body.appendChild(this.winEl),"auto"===this.headerHeight&&(this.headerHeight=this.elements.header.offsetHeight+this.borderWidth)}},{key:"minimize",value:function(){this.minimized=!this.minimized,this.maximized=!1,this.minimized?(this.postMinimizedHeight=this.height,this.height=this.headerHeight+this.borderWidth):this.height=this.postMinimizedHeight,this.updatePosAndShape(),this.emitter.emit("minimizeToggle",this.minimized)}},{key:"checkMaximize",value:function(e){this.resetMaximizedSides(),!this.disablePreview&&this.enableGesture&&(e.clientX<this.maximizeTriggerArea?this.maximizeSides.left=!0:e.clientX>window.innerWidth-this.maximizeTriggerArea?this.maximizeSides.right=!0:e.clientY<this.maximizeTriggerArea&&(this.maximizeSides.top=!0))}},{key:"maximizeTrigger",value:function(e){e.target.isSameNode(this.elements.minimizeBtn)||(this.maximizeSides.top?this.resetWin():(this.maximizeSides.top=!0,this.maximize()))}},{key:"resetWin",value:function(){this.resetMaximizedSides(),this.minimized=!1,this.maximized=!1,this.width=window.innerWidth/2,this.height=window.innerHeight/2,this.x=window.innerWidth/4,this.y=window.innerHeight/4,this.updatePosAndShape()}},{key:"maximize",value:function(){this.minimized=!1,this.preMaximizedWidth=this.width,this.preMaximizedHeight=this.height;var e={x:null,y:null,width:null,height:null};for(var t in this.maximizeSides)if(this.maximizeSides[t])switch(t){case"left":e.x=0,e.y=0,e.width=window.innerWidth/2,e.height=window.innerHeight;break;case"right":e.x=window.innerWidth/2,e.y=0,e.width=window.innerWidth/2,e.height=window.innerHeight;break;case"top":e.x=0,e.y=0,e.width=window.innerWidth,e.height=window.innerHeight}this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this.maximized=!0,this.maximizedData=e,this.emitter.emit("maximizeToggle",e),this.updatePosAndShape()}},{key:"removeEl",value:function(e){var t=0<arguments.length&&void 0!==e?e:null;this.winEl.remove(),this.emitter.emit("remove",t)}},{key:"focus",value:function(e){var t=0<arguments.length&&void 0!==e?e:null;t&&(this.selected=!0,this.windowClickPos=d.getCursorPos(this.winEl,t),this.emitter.emit("focus",t))}},{key:"release",value:function(e){this.selected=!1,"BUTTON"!==e.target.tagName.toUpperCase()&&(Object.values(this.maximizeSides).some(function(e){return e})&&this.maximize(),this.emitter.emit("release",e))}},{key:"drag",value:function(e){var t=this;this.selected&&this.windowClickPos&&(this.maximized&&!this.minimized&&(this.width=this.preMaximizedWidth,this.height=this.preMaximizedHeight,this.windowClickPos.x*=this.preMaximizedWidth/this.maximizedData.width,this.windowClickPos.x<=this.borderWidth?this.windowClickPos.x=this.borderWidth+1:this.windowClickPos.x>=this.width-this.borderWidth&&(this.windowClickPos.x=this.width-this.borderWidth-1),this.disablePreview=!0,setTimeout(function(){t.disablePreview=!1},this.nextMaximizeDelay),this.maximized=!1,this.maximizedData=null),this.x=e.clientX-this.windowClickPos.x,this.y=e.clientY-this.windowClickPos.y,this.checkMaximize(e),this.updatePosAndShape(),this.emitter.emit("drag",e))}},{key:"updatePosAndShape",value:function(){this.winEl.style.left="".concat(this.x,"px"),this.winEl.style.top="".concat(this.y,"px"),this.winEl.style.width="".concat(this.width,"px"),this.winEl.style.height="".concat(this.height,"px")}},{key:"borderSelect",value:function(e){this.resizeStart={x:e.clientX,y:e.clientY},this.mousePosOnBorder=d.getCursorPos(e.target,e),this.preResizeWidth=this.width,this.preResizeHeight=this.height,this.borderSelected=e.target.getAttribute("data-resize"),this.emitter.emit("borderSelect",e)}},{key:"borderLeave",value:function(e){this.resizeStart=null,this.borderSelected=null,this.emitter.emit("borderRelease",e)}},{key:"resize",value:function(e){var t=this,i={right:function(){t.width=e.clientX-t.resizeStart.x+t.preResizeWidth},left:function(){t.x=e.clientX-t.mousePosOnBorder.x,t.width=t.resizeStart.x-e.clientX+t.preResizeWidth,t.width-t.minWidth<=0&&(t.x+=t.width-t.minWidth)},bottom:function(){t.height=e.clientY-t.resizeStart.y+t.preResizeHeight},top:function(){t.y=e.clientY-t.mousePosOnBorder.y,t.height=t.resizeStart.y-e.clientY+t.preResizeHeight,t.height-t.headerHeight<=t.borderWidth&&(t.y+=t.height-t.headerHeight-t.borderWidth)}},n=this.borderSelected.split("-");this.minimized&&(n=n.filter(function(e){return"top"!==e&&"bottom"!==e})),n.forEach(function(e){return i[e]()}),this.width-this.minWidth<=0&&(this.width=this.minWidth),this.height-this.headerHeight<=this.borderWidth&&(this.height=this.headerHeight+this.borderWidth),this.maximized=!1,this.emitter.emit("resize",n),this.updatePosAndShape()}},{key:"isBorderSelected",value:function(){return this.borderSelected}},{key:"getID",value:function(){return this.id}},{key:"isSelected",value:function(){return this.selected}},{key:"isMinimized",value:function(){return this.minimized}},{key:"getEl",value:function(){return this.winEl}},{key:"getMaximizeSide",value:function(){var t=this;return Object.keys(this.maximizeSides).find(function(e){return t.maximizeSides[e]})}},{key:"resetMaximizedSides",value:function(){for(var e in this.maximizeSides)this.maximizeSides[e]=!1}},{key:"getZindex",value:function(){return this.winEl.style.zIndex}},{key:"setZindex",value:function(e){this.winEl.style.zIndex=e}},{key:"getCoord",value:function(){return{x:this.x,y:this.y}}},{key:"getWidth",value:function(){return this.width}},{key:"getHeight",value:function(){return this.height}}]),c);function c(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;_classCallCheck(this,c),this.postMinimizedHeight=null,this.selected=!1,this.borderSelected=null,this.resizeStart=null,this.mousePosOnBorder=null,this.windowClickPos={x:0,y:0},this.winEl=null,this.id="_"+Math.random().toString(36).substr(2,16),this.minimized=!1,this.maximized=!1,this.elements={},this.preResizeWidth=null,this.preResizeHeight=null,this.preMaximizedWidth=null,this.preMaximizedHeight=null,this.maximizedData=null,this.maximizeSides={left:null,right:null,top:null},this.disablePreview=!1,this.content=t,this.emitter=new i,this.name=(null==e?void 0:e.name)||"default",this.borderWidth=(null==e?void 0:e.borderWidth)||3,this.minWidth=null!=e&&e.minWidth?(null==e?void 0:e.minWidth)+2*this.borderWidth:100+2*this.borderWidth,this.headerHeight=null!=e&&e.headerHeight?(null==e?void 0:e.headerHeight)+this.borderWidth:"auto",this.cornerSize=(null==e?void 0:e.cornerSize)||16,this.enableGesture=!0===(null==e?void 0:e.gesture),this.entete=(null==e?void 0:e.entete)||"",this.enteteIcon=(null==e?void 0:e.enteteIcon)||!1,this.width=(null==e?void 0:e.width)||200,this.height=(null==e?void 0:e.height)||200,this.x=isNaN(null==e?void 0:e.x)?200:e.x,this.y=isNaN(null==e?void 0:e.y)?200:e.y,this.maximizeTriggerArea=(null==e?void 0:e.maximizeTriggerArea)||12,this.nextMaximizeDelay=(null==e?void 0:e.nextMaximizeDelay)||500,this.minimizeBtnContent=(null==e?void 0:e.minimizeBtnContent)||"",this.maximizeBtnContent=(null==e?void 0:e.maximizeBtnContent)||"",this.escapeBtnContent=(null==e?void 0:e.escapeBtnContent)||""}function f(){_classCallCheck(this,f),this.list=[],this.focusedID=null,this.startingZI=5,this.maxPreview=new o,document.addEventListener("mousemove",this.targetDrag.bind(this)),document.addEventListener("mouseup",this.deselect.bind(this)),this.emitter=new i,this.eventTypes=["minimizeToggle","maximizeToggle","remove","focus","drag","release","borderSelect","borderRelease","resize"]}return new(_createClass(f,[{key:"getWinByID",value:function(t){return this.list.find(function(e){return e.getID()===t})}},{key:"getAllExceptID",value:function(t){return this.list.filter(function(e){return e.getID()!==t})}},{key:"getSelectedWin",value:function(){return this.list.find(function(e){return e.isSelected()})}},{key:"getBorderSelectedWin",value:function(){return this.list.find(function(e){return e.isBorderSelected()})}},{key:"getWinByZindex",value:function(t){return this.list.find(function(e){return Number(e.getEl().style.zIndex)===t})}},{key:"getFrontWin",value:function(){return this.list.sort(function(e,t){return Number(t.getEl().style.zIndex)-Number(e.getEl().style.zIndex)})[0]}},{key:"getAllWin",value:function(){return this.list}},{key:"closeAllWin",value:function(){for(var e=this.list.length-1;0<=e;e--)this.list[e].removeEl()}},{key:"add",value:function(e,t){var i=this,n=new u(e,t);r(n,"removeEl",function(){return i.removeOfList(n.getID())},!0),r(n,"focus",function(){return i.changeFocus(n.getID())},!0),r(n,"checkMaximize",function(){return i.maxPreview.preview(n.getMaximizeSide(),n.getZindex())},!0,!0),r(n,"release",function(){return i.maxPreview.removePreview()},!0),n.create(),n.getEl(),this.list.push(n),this.initZindex(n.getID()),this.startListening(n)}},{key:"startListening",value:function(n){var r=this;this.eventTypes.map(function(i){n.emitter.on(i,function(e){var t=e.detail;return r.emitter.emit(i,{id:n.id,payload:t})})})}},{key:"removeOfList",value:function(e){this.list.splice(this.list.map(function(e){return e.getID()}).indexOf(e),1)}},{key:"targetDrag",value:function(e){var t=this.getSelectedWin(),i=this.getBorderSelectedWin();t?t.drag(e):i&&i.resize(e)}},{key:"deselect",value:function(e){var t=this.getSelectedWin(),i=this.getBorderSelectedWin();t?t.release(e):i&&i.borderLeave(e)}},{key:"changeFocus",value:function(t){var l,e,i;this.focusedID!==t&&(this.focusedID=t,l=this.list.length+this.startingZI,e=this.getWinByID(t),i=this.getFrontWin(),e.getEl().style.zIndex=l,i.getEl().style.zIndex=l-1,this.list.filter(function(e){return e.id!==t&&e.id!==i.getID()}).sort(function(e,t){return Number(t.getEl().style.zIndex)-Number(e.getEl().style.zIndex)}).forEach(function(e,t,i){var n=e.getEl();if(Number(n.style.zIndex)===l-1)for(var r=t;r<i.length-t;r++){var o=i[r].getEl(),s=Number(o.style.zIndex);if(0<r&&0<Number(i[r-1].getEl().style.zIndex)-s)break;o.style.zIndex=s-1}}))}},{key:"initZindex",value:function(e){this.getWinByID(e).getEl().style.zIndex=this.list.length+this.startingZI}}]),f)});